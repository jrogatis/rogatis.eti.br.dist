{"version":3,"sources":["api/sitemap/sitemap.controller.js"],"names":["index","basicMap","hostname","cacheTime","urls","url","changefreq","priority","sitemap","res","find","exec","then","map","createSitemap","posts","add","post","slug","toXML","err","xml","console","log","status","header","send","toString","req"],"mappings":"AAAA;;;;AAIA;;;;;QAiDgBA,K,GAAAA,K;;AAhDhB;;;;AACA;;;;;;AAGA,IAAIC,WAAW;AACTC,YAAU,2BADD;AAETC,aAAW,MAFF,EAEU;AACnBC,QAAM,CACJ;AACEC,SAAK,GADP;AAEEC,gBAAY,OAFd;AAGEC,cAAU;AAHZ,GADI,EAMJ;AACEF,SAAK,WADP;AAEEC,gBAAY,SAFd;AAGEC,cAAU;AAHZ,GANI,EAWH;AACCF,SAAK,OADN;AAECC,gBAAY,OAFb;AAGCC,cAAU;AAHX,GAXG,EAgBJ;AACEF,SAAK,UADP;AAEEC,gBAAY,SAFd;AAGEC,cAAU;AAHZ,GAhBI;AAHG,CAAf;;AA2BA,SAASC,OAAT,CAAiBC,GAAjB,EAAsB;AACpB,kBAAMC,IAAN,GAAaC,IAAb,GACCC,IADD,CACM,iBAAS;;AAEb,QAAIC,MAAM,kBAAGC,aAAH,CAAiBb,QAAjB,CAAV;AACAc,UAAMF,GAAN,CAAU,gBAAM;AACdA,UAAIG,GAAJ,CAAQ,EAACX,WAAQY,KAAKC,IAAd,EAAR;AACD,KAFD;AAGAL,QAAIM,KAAJ,CAAW,UAASC,GAAT,EAAcC,GAAd,EAAkB;AAAE,UAAI,CAACD,GAAL,EAAS;AAAEE,gBAAQC,GAAR,CAAYF,GAAZ;AAAkB;AAAE,KAA9D;AACAC,YAAQC,GAAR,CAAYV,GAAZ;AACA,WAAOJ,IAAIe,MAAJ,CAAW,GAAX,EAAgBC,MAAhB,CAAuB,cAAvB,EAAuC,iBAAvC,EAA0DC,IAA1D,CAA+Db,IAAIc,QAAJ,EAA/D,CAAP;AACC,GAVH;AAYD;;AAGD;AACO,SAAS3B,KAAT,CAAe4B,GAAf,EAAoBnB,GAApB,EAAyB;AAC9B,SAAOD,QAAQC,GAAR,CAAP;AACD","file":"sitemap.controller.js","sourcesContent":["/**\n * Using Rails-like standard naming convention for endpoints.\n * GET     /api/sitemap              ->  index\n */\n'use strict';\nimport sm from 'sitemap'\nimport Posts from '../posts/posts.model';\n\n\nvar basicMap = {\n      hostname: 'http://www.rogatis.eti.br',\n      cacheTime: 600000, // 600 sec cache period\n      urls: [\n        {\n          url: '/',\n          changefreq: 'daily',\n          priority: 0.3\n        },\n        {\n          url: '/porfolio',\n          changefreq: 'monthly',\n          priority: 0.7\n        },\n         {\n          url: '/blog',\n          changefreq: 'daily',\n          priority: 0.5\n        },\n        {\n          url: '/contact',\n          changefreq: 'monthly',\n          priority: 0.7\n        }\n        ]\n      };\n\nfunction sitemap(res) {\n  Posts.find().exec()\n  .then(posts => {\n\n    let map = sm.createSitemap(basicMap);\n    posts.map(post=>{\n      map.add({url:`/${post.slug}`})\n    })\n    map.toXML( function(err, xml){ if (!err){ console.log(xml) } });\n    console.log(map);\n    return res.status(200).header('Content-Type', 'application/xml').send(map.toString());\n    }\n  )\n}\n\n\n// Gets a site map\nexport function index(req, res) {\n  return sitemap(res)\n}\n\n"]}
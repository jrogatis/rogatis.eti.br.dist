{"version":3,"sources":["api/sitemap/sitemap.controller.js"],"names":["index","basicMap","hostname","cacheTime","urls","url","changefreq","priority","sitemap","res","find","exec","then","map","createSitemap","posts","add","post","slug","toXML","err","xml","console","log","status","header","send","toString","req"],"mappings":"AAAA;;;;AAIA;;;;;QAmDgBA,K,GAAAA,K;;AAlDhB;;;;AACA;;;;;;AAEA,IAAIC,WAAW;AACbC,YAAU,2BADG;AAEbC,aAAW,MAFE,EAEM;AACnBC,QAAM,CACJ;AACEC,SAAK,GADP;AAEEC,gBAAY,OAFd;AAGEC,cAAU;AAHZ,GADI,EAMJ;AACEF,SAAK,WADP;AAEEC,gBAAY,SAFd;AAGEC,cAAU;AAHZ,GANI,EAWJ;AACEF,SAAK,OADP;AAEEC,gBAAY,OAFd;AAGEC,cAAU;AAHZ,GAXI,EAgBJ;AACEF,SAAK,UADP;AAEEC,gBAAY,SAFd;AAGEC,cAAU;AAHZ,GAhBI;AAHO,CAAf;;AA2BA,SAASC,OAAT,CAAiBC,GAAjB,EAAsB;AACpB,kBAAMC,IAAN,GAAaC,IAAb,GACGC,IADH,CACQ,iBAAS;;AAEb,QAAIC,MAAM,kBAAGC,aAAH,CAAiBb,QAAjB,CAAV;AACAc,UAAMF,GAAN,CAAU,gBAAQ;AAChBA,UAAIG,GAAJ,CAAQ;AACNX,mBAASY,KAAKC;AADR,OAAR;AAGD,KAJD;AAKAL,QAAIM,KAAJ,CAAU,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AAC5B,UAAG,CAACD,GAAJ,EAAS;AACPE,gBAAQC,GAAR,CAAYH,GAAZ,EAAiBC,GAAjB;AACD;AACF,KAJD;AAKA,WAAOZ,IAAIe,MAAJ,CAAW,GAAX,EAAgBC,MAAhB,CAAuB,cAAvB,EAAuC,iBAAvC,EAA0DC,IAA1D,CAA+Db,IAAIc,QAAJ,EAA/D,CAAP;AACD,GAfH;AAgBD;;AAED;AACO,SAAS3B,KAAT,CAAe4B,GAAf,EAAoBnB,GAApB,EAAyB;AAC9B,SAAOD,QAAQC,GAAR,CAAP;AACD","file":"sitemap.controller.js","sourcesContent":["/**\n * Using Rails-like standard naming convention for endpoints.\n * GET     /api/sitemap              ->  index\n */\n'use strict';\nimport sm from 'sitemap';\nimport Posts from '../posts/posts.model';\n\nvar basicMap = {\n  hostname: 'http://www.rogatis.eti.br',\n  cacheTime: 600000, // 600 sec cache peÃ¥riod\n  urls: [\n    {\n      url: '/',\n      changefreq: 'daily',\n      priority: 0.3\n        },\n    {\n      url: '/porfolio',\n      changefreq: 'monthly',\n      priority: 0.7\n        },\n    {\n      url: '/blog',\n      changefreq: 'daily',\n      priority: 0.5\n        },\n    {\n      url: '/contact',\n      changefreq: 'monthly',\n      priority: 0.7\n        }\n        ]\n};\n\nfunction sitemap(res) {\n  Posts.find().exec()\n    .then(posts => {\n\n      let map = sm.createSitemap(basicMap);\n      posts.map(post => {\n        map.add({\n          url: `/${post.slug}`\n        })\n      })\n      map.toXML(function (err, xml) {\n        if(!err) {\n          console.log(err, xml);\n        }\n      });\n      return res.status(200).header('Content-Type', 'application/xml').send(map.toString());\n    })\n}\n\n// Gets a site map\nexport function index(req, res) {\n  return sitemap(res);\n}\n"]}